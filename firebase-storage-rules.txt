// Règles Firebase Storage à configurer dans la console Firebase
// Allez sur https://console.firebase.google.com/project/citylog-7e98e/storage/rules

// RÈGLES TEMPORAIRES POUR LES TESTS (plus permissives)
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      allow read, write: if request.auth != null;
    }
  }
}

// RÈGLES FINALES RECOMMANDÉES (plus sécurisées)
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Images des posts - accessible à tous pour la lecture, écriture pour les utilisateurs connectés
    match /posts/{postId}/{itemType}/{fileName} {
      allow read: if true;
      allow write: if request.auth != null 
                   && request.auth.uid != null
                   && resource == null; // Empêche la modification des fichiers existants
    }
    
    // Images des profils utilisateurs
    match /profiles/{userId}/{fileName} {
      allow read: if true;
      allow write: if request.auth != null 
                   && request.auth.uid == userId;
    }
    
    // Autres fichiers - accès restreint
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
